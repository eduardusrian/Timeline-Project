<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KPI Monitoring Dashboard</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    * {
      font-family: 'Plus Jakarta Sans', sans-serif;
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    .stat-card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .stat-card:hover {
      transform: translateY(-4px);
    }
    .nav-item {
      transition: all 0.2s ease;
    }
    .nav-item.active {
      color: #667eea;
    }
    .nav-item.active svg {
      stroke: #667eea;
    }
    .pulse-dot {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .slide-up {
      animation: slideUp 0.5s ease-out;
    }
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .progress-ring {
      transition: stroke-dashoffset 0.5s ease-in-out;
    }
    .notification-badge {
      animation: bounce 1s ease infinite;
    }
    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
  </style>
 </head>
 <body class="h-full bg-gradient-to-br from-slate-50 via-purple-50 to-indigo-100 overflow-auto">
  <div id="app" class="h-full w-full flex flex-col"><!-- Header Section -->
   <header class="px-4 pt-4 pb-2">
    <div class="glass-card rounded-2xl p-4 shadow-lg slide-up">
     <div class="flex items-center justify-between"><!-- Profile Section -->
      <div class="flex items-center gap-3">
       <div class="relative">
        <div class="w-14 h-14 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-xl font-bold shadow-lg"><span id="user-avatar">AB</span>
        </div>
        <div class="absolute -bottom-1 -right-1 w-5 h-5 bg-emerald-500 rounded-full border-2 border-white flex items-center justify-center">
         <svg class="w-3 h-3 text-white" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
         </svg>
        </div>
       </div>
       <div>
        <h2 id="display-name" class="font-bold text-gray-800 text-lg">Ahmad Budiman</h2>
        <div class="flex items-center gap-2"><span id="display-role" class="text-sm text-indigo-600 font-semibold">Business Builder</span> <span class="px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs rounded-full font-medium">Active</span>
        </div>
       </div>
      </div><!-- Notification Bell --> <button id="notification-btn" class="relative p-3 rounded-xl bg-white shadow-md hover:shadow-lg transition-all">
       <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
       </svg><span id="notification-count" class="notification-badge absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold">3</span> </button>
     </div><!-- Due Date Info -->
     <div class="mt-3 flex items-center gap-2 px-3 py-2 bg-amber-50 rounded-xl border border-amber-200">
      <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg><span class="text-sm text-amber-800">Jatuh Tempo: <strong>28 Februari 2025</strong></span>
     </div>
    </div>
   </header><!-- Main Content -->
   <main class="flex-1 px-4 py-2 overflow-auto"><!-- ===== HOME TAB ===== -->
    <div id="tab-home" class="tab-content active"><!-- Notification Panel (Hidden by default) -->
     <div id="notification-panel" class="hidden glass-card rounded-2xl p-4 mb-4 shadow-lg slide-up">
      <div class="flex items-center justify-between mb-3">
       <h3 class="font-bold text-gray-800">üîî Notifikasi</h3><button id="close-notif" class="text-gray-400 hover:text-gray-600">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg></button>
      </div>
      <div class="space-y-2">
       <div class="flex items-start gap-3 p-3 bg-blue-50 rounded-xl border border-blue-200">
        <div class="w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center flex-shrink-0">
         <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
         </svg>
        </div>
        <div>
         <p class="text-sm font-semibold text-gray-800">Update Tersedia v2.5.0</p>
         <p class="text-xs text-gray-600">Fitur baru dan perbaikan bug</p>
        </div>
       </div>
       <div class="flex items-start gap-3 p-3 bg-purple-50 rounded-xl border border-purple-200">
        <div class="w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center flex-shrink-0">
         <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
         </svg>
        </div>
        <div>
         <p class="text-sm font-semibold text-gray-800">Upgrade ke Academy</p>
         <p class="text-xs text-gray-600">Tingkatkan level Anda sekarang!</p>
        </div>
       </div>
       <div class="flex items-start gap-3 p-3 bg-emerald-50 rounded-xl border border-emerald-200">
        <div class="w-8 h-8 bg-emerald-500 rounded-lg flex items-center justify-center flex-shrink-0">
         <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
         </svg>
        </div>
        <div>
         <p class="text-sm font-semibold text-gray-800">Target Mingguan Tercapai!</p>
         <p class="text-xs text-gray-600">Selamat! Anda mencapai 105%</p>
        </div>
       </div>
      </div>
     </div><!-- TYFCB Progress Card -->
     <div class="glass-card rounded-2xl p-4 mb-4 shadow-lg slide-up">
      <div class="flex items-center justify-between mb-3">
       <h3 class="font-bold text-gray-800">üìä Progress TYFCB</h3><span class="text-xs text-gray-500">Target Bulanan</span>
      </div>
      <div class="flex items-center gap-4">
       <div class="relative">
        <svg class="w-24 h-24 transform -rotate-90"><circle cx="48" cy="48" r="40" stroke="#e5e7eb" stroke-width="8" fill="none" /> <circle id="progress-circle" cx="48" cy="48" r="40" stroke="url(#gradient)" stroke-width="8" fill="none" stroke-linecap="round" stroke-dasharray="251.2" stroke-dashoffset="75.36" class="progress-ring" /> <defs>
          <lineargradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
           <stop offset="0%" stop-color="#667eea" />
           <stop offset="100%" stop-color="#764ba2" />
          </lineargradient>
         </defs>
        </svg>
        <div class="absolute inset-0 flex items-center justify-center"><span id="progress-percent" class="text-xl font-bold text-gray-800">70%</span>
        </div>
       </div>
       <div class="flex-1">
        <div class="mb-2">
         <p class="text-sm text-gray-600">Tercapai</p>
         <p id="tyfcb-achieved" class="text-2xl font-bold text-indigo-600">Rp 35.000.000</p>
        </div>
        <div>
         <p class="text-sm text-gray-600">Target</p>
         <p id="tyfcb-target" class="text-lg font-semibold text-gray-800">Rp 50.000.000</p>
        </div>
       </div>
      </div>
     </div><!-- Stats Grid -->
     <div class="grid grid-cols-2 gap-3 mb-4">
      <div class="stat-card glass-card rounded-2xl p-4 shadow-lg">
       <div class="flex items-center gap-2 mb-2">
        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center">
         <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
         </svg>
        </div><span class="text-xs text-gray-500">Minggu Ini</span>
       </div>
       <p id="weekly-slips" class="text-2xl font-bold text-gray-800">12</p>
       <p class="text-sm text-gray-600">Total Slips</p>
      </div>
      <div class="stat-card glass-card rounded-2xl p-4 shadow-lg">
       <div class="flex items-center gap-2 mb-2">
        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-emerald-600 flex items-center justify-center">
         <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
         </svg>
        </div><span class="text-xs text-gray-500">Bulan Ini</span>
       </div>
       <p id="monthly-visitors" class="text-2xl font-bold text-gray-800">48</p>
       <p class="text-sm text-gray-600">Visitors</p>
      </div>
      <div class="stat-card glass-card rounded-2xl p-4 shadow-lg">
       <div class="flex items-center gap-2 mb-2">
        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center">
         <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
         </svg>
        </div><span class="text-xs text-gray-500">Total</span>
       </div>
       <p id="total-speakers" class="text-2xl font-bold text-gray-800">8</p>
       <p class="text-sm text-gray-600">Speakers</p>
      </div>
      <div class="stat-card glass-card rounded-2xl p-4 shadow-lg">
       <div class="flex items-center gap-2 mb-2">
        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-amber-500 to-orange-500 flex items-center justify-center">
         <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
         </svg>
        </div><span class="text-xs text-gray-500">Growth</span>
       </div>
       <p class="text-2xl font-bold text-emerald-600">+23%</p>
       <p class="text-sm text-gray-600">vs Bulan Lalu</p>
      </div>
     </div><!-- Upcoming Meeting -->
     <div class="glass-card rounded-2xl p-4 mb-4 shadow-lg slide-up">
      <div class="flex items-center justify-between mb-3">
       <h3 class="font-bold text-gray-800">üìÖ Meeting Berikutnya</h3><span class="px-3 py-1 bg-indigo-100 text-indigo-700 text-xs rounded-full font-semibold">Online</span>
      </div>
      <div class="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl p-4 text-white">
       <div class="flex items-center gap-3 mb-3">
        <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur">
         <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
         </svg>
        </div>
        <div>
         <p class="font-bold text-lg">Senin, 24 Feb 2025</p>
         <p class="text-white/80 text-sm">19:00 - 21:00 WIB</p>
        </div>
       </div>
       <div class="grid grid-cols-3 gap-2 pt-3 border-t border-white/20">
        <div class="text-center">
         <p class="text-2xl font-bold">5</p>
         <p class="text-xs text-white/80">Speakers</p>
        </div>
        <div class="text-center border-x border-white/20">
         <p class="text-2xl font-bold">120</p>
         <p class="text-xs text-white/80">Expected</p>
        </div>
        <div class="text-center">
         <p class="text-2xl font-bold">2.5M</p>
         <p class="text-xs text-white/80">Est. TYFCB</p>
        </div>
       </div>
      </div>
     </div><!-- Recent Activity -->
     <div class="glass-card rounded-2xl p-4 mb-24 shadow-lg slide-up">
      <div class="flex items-center justify-between mb-3">
       <h3 class="font-bold text-gray-800">üìù Aktivitas Terbaru</h3><button id="add-activity-btn" class="px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg font-medium hover:bg-indigo-700 transition-colors"> + Tambah </button>
      </div>
      <div id="activity-list" class="space-y-2"><!-- Activities will be rendered here -->
       <div class="text-center py-6 text-gray-500">
        <svg class="w-12 h-12 mx-auto mb-2 text-gray-300" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
        </svg>
        <p class="text-sm">Belum ada aktivitas</p>
        <p class="text-xs">Klik "Tambah" untuk mencatat aktivitas baru</p>
       </div>
      </div>
     </div>
    </div><!-- ===== SLIPS TAB ===== -->
    <div id="tab-slips" class="tab-content">
     <div class="glass-card rounded-2xl p-4 mb-4 shadow-lg slide-up">
      <h3 class="font-bold text-gray-800 mb-4">üìÑ Daftar Slip Mingguan</h3>
      <div id="slips-list" class="space-y-3"><!-- Slips will be rendered here -->
      </div>
     </div>
    </div><!-- ===== COMMUNITY TAB ===== -->
    <div id="tab-community" class="tab-content">
     <div class="glass-card rounded-2xl p-4 mb-4 shadow-lg slide-up">
      <h3 class="font-bold text-gray-800 mb-4">üë• Komunitas</h3>
      <div class="space-y-3">
       <div class="flex items-center gap-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200">
        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-full flex items-center justify-center text-white font-bold">
         üë®
        </div>
        <div>
         <p class="font-semibold text-gray-800">Anggota Aktif</p>
         <p class="text-sm text-gray-600">1,245 orang bergabung</p>
        </div>
       </div>
       <div class="flex items-center gap-3 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200">
        <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold">
         üí¨
        </div>
        <div>
         <p class="font-semibold text-gray-800">Diskusi Aktif</p>
         <p class="text-sm text-gray-600">892 percakapan minggu ini</p>
        </div>
       </div>
       <div class="flex items-center gap-3 p-4 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl border border-emerald-200">
        <div class="w-12 h-12 bg-gradient-to-br from-emerald-500 to-teal-500 rounded-full flex items-center justify-center text-white font-bold">
         üèÜ
        </div>
        <div>
         <p class="font-semibold text-gray-800">Top Contributor</p>
         <p class="text-sm text-gray-600">Anda rank #12 komunitas</p>
        </div>
       </div>
      </div>
     </div>
    </div><!-- ===== VISITORS TAB ===== -->
    <div id="tab-visitors" class="tab-content">
     <div class="glass-card rounded-2xl p-4 mb-4 shadow-lg slide-up">
      <h3 class="font-bold text-gray-800 mb-4">üë• Daftar Visitors</h3>
      <div id="visitors-list" class="space-y-3"><!-- Visitors will be rendered here -->
      </div>
     </div>
    </div><!-- ===== SEARCH TAB ===== -->
    <div id="tab-search" class="tab-content">
     <div class="glass-card rounded-2xl p-4 mb-4 shadow-lg">
      <div class="relative mb-4">
       <svg class="w-5 h-5 text-gray-400 absolute left-3 top-3" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
       </svg><input type="text" id="search-input" placeholder="Cari aktivitas, visitor, atau slip..." class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
      </div>
      <div id="search-results" class="space-y-3">
       <p class="text-center text-gray-500 py-8">Ketik untuk mencari...</p>
      </div>
     </div>
    </div>
   </main><!-- Add Activity Modal -->
   <div id="add-modal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end justify-center">
    <div class="bg-white rounded-t-3xl w-full max-w-lg p-6 slide-up">
     <div class="flex items-center justify-between mb-4">
      <h3 class="font-bold text-lg text-gray-800">Tambah Aktivitas</h3><button id="close-modal" class="p-2 hover:bg-gray-100 rounded-full">
       <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
       </svg></button>
     </div>
     <form id="activity-form" class="space-y-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-1" for="activity-type">Tipe Aktivitas</label> <select id="activity-type" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent"> <option value="slip">Slip</option> <option value="visitor">Visitor</option> <option value="speaker">Speaker</option> <option value="meeting">Meeting</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-1" for="activity-title">Judul</label> <input type="text" id="activity-title" placeholder="Contoh: Presentasi Produk A" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-1" for="activity-value">Nilai TYFCB (Rp)</label> <input type="number" id="activity-value" placeholder="0" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-1" for="activity-notes">Catatan</label> <textarea id="activity-notes" rows="2" placeholder="Catatan tambahan..." class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none"></textarea>
      </div><button type="submit" id="submit-btn" class="w-full py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold rounded-xl hover:opacity-90 transition-opacity"> Simpan Aktivitas </button>
     </form>
    </div>
   </div><!-- Bottom Navigation -->
   <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-2 py-2 z-40">
    <div class="flex items-center justify-around max-w-lg mx-auto"><button class="nav-item active flex flex-col items-center p-2 rounded-xl transition-colors" data-tab="home">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
      </svg><span class="text-xs mt-1 font-medium">Home</span> </button> <button class="nav-item flex flex-col items-center p-2 rounded-xl text-gray-500 transition-colors" data-tab="slips">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
      </svg><span class="text-xs mt-1 font-medium">Slips</span> </button> <button class="nav-item flex flex-col items-center p-2 rounded-xl text-gray-500 transition-colors" data-tab="community">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
      </svg><span class="text-xs mt-1 font-medium">Community</span> </button> <button class="nav-item flex flex-col items-center p-2 rounded-xl text-gray-500 transition-colors" data-tab="visitors">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
      </svg><span class="text-xs mt-1 font-medium">Visitors</span> </button> <button class="nav-item flex flex-col items-center p-2 rounded-xl text-gray-500 transition-colors" data-tab="search">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg><span class="text-xs mt-1 font-medium">Search</span> </button>
    </div>
   </nav>
  </div>
  <script>
    // Default configuration
    const defaultConfig = {
      user_name: 'Ahmad Budiman',
      user_role: 'Business Builder',
      target_tyfcb: '50000000',
      background_color: '#f8fafc',
      surface_color: '#ffffff',
      text_color: '#1f2937',
      primary_action: '#667eea',
      secondary_action: '#6b7280'
    };

    let config = { ...defaultConfig };
    let activities = [];
    let currentRecordCount = 0;

    // Format currency
    function formatCurrency(value) {
      return new Intl.NumberFormat('id-ID', {
        style: 'currency',
        currency: 'IDR',
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
      }).format(value);
    }

    // Get initials from name
    function getInitials(name) {
      return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
    }

    // Calculate TYFCB from activities
    function calculateTYFCB() {
      return activities.reduce((sum, act) => sum + (Number(act.value) || 0), 0);
    }

    // Update progress ring
    function updateProgress() {
      const achieved = calculateTYFCB();
      const target = Number(config.target_tyfcb) || 50000000;
      const percent = Math.min(Math.round((achieved / target) * 100), 100);
      
      const circle = document.getElementById('progress-circle');
      const circumference = 251.2;
      const offset = circumference - (percent / 100) * circumference;
      circle.style.strokeDashoffset = offset;
      
      document.getElementById('progress-percent').textContent = percent + '%';
      document.getElementById('tyfcb-achieved').textContent = formatCurrency(achieved);
      document.getElementById('tyfcb-target').textContent = formatCurrency(target);
    }

    // Update stats
    function updateStats() {
      const now = new Date();
      const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
      
      const weeklySlips = activities.filter(a => 
        a.type === 'slip' && new Date(a.created_at) >= weekAgo
      ).length;
      
      const monthlyVisitors = activities.filter(a => 
        a.type === 'visitor'
      ).length;
      
      const totalSpeakers = activities.filter(a => 
        a.type === 'speaker'
      ).length;
      
      document.getElementById('weekly-slips').textContent = weeklySlips || activities.filter(a => a.type === 'slip').length;
      document.getElementById('monthly-visitors').textContent = monthlyVisitors || 48;
      document.getElementById('total-speakers').textContent = totalSpeakers || 8;
    }

    // Render activities
    function renderActivities() {
      const container = document.getElementById('activity-list');
      
      if (activities.length === 0) {
        container.innerHTML = `
          <div class="text-center py-6 text-gray-500">
            <svg class="w-12 h-12 mx-auto mb-2 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
            </svg>
            <p class="text-sm">Belum ada aktivitas</p>
            <p class="text-xs">Klik "Tambah" untuk mencatat aktivitas baru</p>
          </div>
        `;
        return;
      }

      const typeIcons = {
        slip: 'üìÑ',
        visitor: 'üë§',
        speaker: 'üé§',
        meeting: 'üìÖ'
      };

      const typeColors = {
        slip: 'bg-blue-100 text-blue-700',
        visitor: 'bg-emerald-100 text-emerald-700',
        speaker: 'bg-purple-100 text-purple-700',
        meeting: 'bg-amber-100 text-amber-700'
      };

      container.innerHTML = activities
        .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
        .slice(0, 5)
        .map(activity => `
          <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors" data-id="${activity.__backendId}">
            <div class="w-10 h-10 rounded-xl ${typeColors[activity.type] || 'bg-gray-100 text-gray-700'} flex items-center justify-center text-lg">
              ${typeIcons[activity.type] || 'üìã'}
            </div>
            <div class="flex-1 min-w-0">
              <p class="font-semibold text-gray-800 truncate">${activity.title}</p>
              <p class="text-xs text-gray-500">${new Date(activity.created_at).toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' })}</p>
            </div>
            <div class="text-right">
              <p class="font-bold text-indigo-600 text-sm">${formatCurrency(activity.value || 0)}</p>
              <button class="delete-btn text-xs text-red-500 hover:text-red-700" data-id="${activity.__backendId}">Hapus</button>
            </div>
          </div>
        `).join('');

      // Add delete event listeners
      container.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', async (e) => {
          e.stopPropagation();
          const id = btn.dataset.id;
          const activity = activities.find(a => a.__backendId === id);
          if (activity) {
            btn.textContent = 'Menghapus...';
            btn.disabled = true;
            const result = await window.dataSdk.delete(activity);
            if (!result.isOk) {
              btn.textContent = 'Hapus';
              btn.disabled = false;
              showToast('Gagal menghapus aktivitas', 'error');
            }
          }
        });
      });
    }

    // Render slips
    function renderSlips() {
      const container = document.getElementById('slips-list');
      const slips = activities.filter(a => a.type === 'slip');
      
      if (slips.length === 0) {
        container.innerHTML = '<p class="text-center text-gray-500 py-6">Belum ada slip</p>';
        return;
      }

      container.innerHTML = slips
        .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
        .map(slip => `
          <div class="p-4 bg-blue-50 rounded-xl border border-blue-200">
            <div class="flex items-start justify-between">
              <div>
                <p class="font-semibold text-gray-800">${slip.title}</p>
                <p class="text-xs text-gray-600 mt-1">${new Date(slip.created_at).toLocaleDateString('id-ID')}</p>
              </div>
              <p class="font-bold text-blue-600">${formatCurrency(slip.value || 0)}</p>
            </div>
            ${slip.notes ? `<p class="text-sm text-gray-600 mt-2">${slip.notes}</p>` : ''}
          </div>
        `).join('');
    }

    // Render visitors
    function renderVisitors() {
      const container = document.getElementById('visitors-list');
      const visitors = activities.filter(a => a.type === 'visitor');
      
      if (visitors.length === 0) {
        container.innerHTML = '<p class="text-center text-gray-500 py-6">Belum ada visitor</p>';
        return;
      }

      container.innerHTML = visitors
        .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
        .map(visitor => `
          <div class="p-4 bg-emerald-50 rounded-xl border border-emerald-200">
            <div class="flex items-start justify-between">
              <div>
                <p class="font-semibold text-gray-800">${visitor.title}</p>
                <p class="text-xs text-gray-600 mt-1">${new Date(visitor.created_at).toLocaleDateString('id-ID')}</p>
              </div>
              <p class="font-bold text-emerald-600">${formatCurrency(visitor.value || 0)}</p>
            </div>
            ${visitor.notes ? `<p class="text-sm text-gray-600 mt-2">${visitor.notes}</p>` : ''}
          </div>
        `).join('');
    }

    // Search function
    function performSearch(query) {
      const container = document.getElementById('search-results');
      if (!query.trim()) {
        container.innerHTML = '<p class="text-center text-gray-500 py-8">Ketik untuk mencari...</p>';
        return;
      }

      const results = activities.filter(a => 
        a.title.toLowerCase().includes(query.toLowerCase()) ||
        a.notes?.toLowerCase().includes(query.toLowerCase())
      );

      if (results.length === 0) {
        container.innerHTML = '<p class="text-center text-gray-500 py-8">Tidak ada hasil ditemukan</p>';
        return;
      }

      container.innerHTML = results
        .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
        .map(item => `
          <div class="p-3 bg-gray-50 rounded-xl">
            <div class="flex items-center gap-2 mb-2">
              <span class="px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs rounded-full font-semibold">${item.type}</span>
              <p class="text-xs text-gray-600">${new Date(item.created_at).toLocaleDateString('id-ID')}</p>
            </div>
            <p class="font-semibold text-gray-800">${item.title}</p>
            <p class="text-sm text-indigo-600 font-bold mt-1">${formatCurrency(item.value || 0)}</p>
          </div>
        `).join('');
    }

    // Show toast message
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `fixed top-4 left-1/2 -translate-x-1/2 px-4 py-2 rounded-lg text-white text-sm font-medium z-50 ${type === 'success' ? 'bg-emerald-500' : 'bg-red-500'} slide-up`;
      toast.textContent = message;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    // Switch tabs
    function switchTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.getElementById(`tab-${tabName}`).classList.add('active');

      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

      if (tabName === 'slips') renderSlips();
      if (tabName === 'visitors') renderVisitors();
    }

    // Data handler for SDK
    const dataHandler = {
      onDataChanged(data) {
        activities = data;
        currentRecordCount = data.length;
        renderActivities();
        updateProgress();
        updateStats();
      }
    };

    // Initialize Element SDK
    async function initElementSdk() {
      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (newConfig) => {
            config = { ...defaultConfig, ...newConfig };
            
            document.getElementById('display-name').textContent = config.user_name || defaultConfig.user_name;
            document.getElementById('display-role').textContent = config.user_role || defaultConfig.user_role;
            document.getElementById('user-avatar').textContent = getInitials(config.user_name || defaultConfig.user_name);
            
            updateProgress();
          },
          mapToCapabilities: (cfg) => ({
            recolorables: [
              {
                get: () => cfg.background_color || defaultConfig.background_color,
                set: (v) => { cfg.background_color = v; window.elementSdk.setConfig({ background_color: v }); }
              },
              {
                get: () => cfg.surface_color || defaultConfig.surface_color,
                set: (v) => { cfg.surface_color = v; window.elementSdk.setConfig({ surface_color: v }); }
              },
              {
                get: () => cfg.text_color || defaultConfig.text_color,
                set: (v) => { cfg.text_color = v; window.elementSdk.setConfig({ text_color: v }); }
              },
              {
                get: () => cfg.primary_action || defaultConfig.primary_action,
                set: (v) => { cfg.primary_action = v; window.elementSdk.setConfig({ primary_action: v }); }
              },
              {
                get: () => cfg.secondary_action || defaultConfig.secondary_action,
                set: (v) => { cfg.secondary_action = v; window.elementSdk.setConfig({ secondary_action: v }); }
              }
            ],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (cfg) => new Map([
            ['user_name', cfg.user_name || defaultConfig.user_name],
            ['user_role', cfg.user_role || defaultConfig.user_role],
            ['target_tyfcb', cfg.target_tyfcb || defaultConfig.target_tyfcb]
          ])
        });
      }
    }

    // Initialize Data SDK
    async function initDataSdk() {
      if (window.dataSdk) {
        const result = await window.dataSdk.init(dataHandler);
        if (!result.isOk) {
          console.error('Failed to initialize Data SDK');
        }
      }
    }

    // DOM Elements
    const notificationBtn = document.getElementById('notification-btn');
    const notificationPanel = document.getElementById('notification-panel');
    const closeNotif = document.getElementById('close-notif');
    const addActivityBtn = document.getElementById('add-activity-btn');
    const addModal = document.getElementById('add-modal');
    const closeModal = document.getElementById('close-modal');
    const activityForm = document.getElementById('activity-form');
    const submitBtn = document.getElementById('submit-btn');
    const navItems = document.querySelectorAll('.nav-item');
    const searchInput = document.getElementById('search-input');

    // Event Listeners
    notificationBtn.addEventListener('click', () => {
      notificationPanel.classList.toggle('hidden');
    });

    closeNotif.addEventListener('click', () => {
      notificationPanel.classList.add('hidden');
    });

    addActivityBtn.addEventListener('click', () => {
      addModal.classList.remove('hidden');
    });

    closeModal.addEventListener('click', () => {
      addModal.classList.add('hidden');
    });

    addModal.addEventListener('click', (e) => {
      if (e.target === addModal) {
        addModal.classList.add('hidden');
      }
    });

    activityForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      if (currentRecordCount >= 999) {
        showToast('Batas maksimum 999 aktivitas tercapai. Hapus beberapa aktivitas terlebih dahulu.', 'error');
        return;
      }

      const type = document.getElementById('activity-type').value;
      const title = document.getElementById('activity-title').value.trim();
      const value = document.getElementById('activity-value').value;
      const notes = document.getElementById('activity-notes').value.trim();

      if (!title) {
        showToast('Judul aktivitas harus diisi', 'error');
        return;
      }

      submitBtn.textContent = 'Menyimpan...';
      submitBtn.disabled = true;

      const newActivity = {
        id: Date.now().toString(),
        type,
        title,
        value: Number(value) || 0,
        date: new Date().toISOString().split('T')[0],
        status: 'completed',
        notes,
        created_at: new Date().toISOString()
      };

      const result = await window.dataSdk.create(newActivity);
      
      submitBtn.textContent = 'Simpan Aktivitas';
      submitBtn.disabled = false;

      if (result.isOk) {
        activityForm.reset();
        addModal.classList.add('hidden');
        showToast('Aktivitas berhasil ditambahkan!');
      } else {
        showToast('Gagal menyimpan aktivitas', 'error');
      }
    });

    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const tabName = item.dataset.tab;
        switchTab(tabName);
      });
    });

    searchInput.addEventListener('input', (e) => {
      performSearch(e.target.value);
    });

    // Initialize app
    async function init() {
      await initElementSdk();
      await initDataSdk();
      updateProgress();
      updateStats();
    }

    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cc9758b26569fa1',t:'MTc3MDg3MTc2NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
